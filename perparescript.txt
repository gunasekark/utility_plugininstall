usage()
{
cat << EOF
usage: $0 options

This script deploys to instances in an autoscaling group.

OPTIONS:
 -h      Show this message
 -p      Dependency PluginName version : git:1.2.3,test:latest  -- REQUIRED)
 -d      Plugin Directory : $PLUGIN_DIR)
 -s              URL path to download
 -o      Plugin owner
EOF
}

track_error()
{
   if [ $1 != "0" ]; then
        log "Execution Error on $2"
        log "completed execution IN ERROR at `date`"
        exit $1
   fi

}

log()
{
   echo "`date +'%D %T'` : $1"
}
installplugin()
{
        log "installing $1"
        plugin_need_tobe_installed=$1

        plugin_name=
        plugin_version=
}
checkdependency()
{
        log "verifying $1"
}

PLUGIN_NAME=""
PLUGIN_SOURCE=""
PLUGIN_DIR=/var/lib/jenkins/plugins
FILE_OWNER=jenkins.jenkins
CURL_CMD="/cygdrive/c/ProgramFilesx86/Git/bin/curl -s -o /dev/null -w '%{http_code}'"

while getopts .d:h:p:o:s. OPTION
do
     case $OPTION in
                 d)
                         PLUGIN_DIR=$OPTARG
                         ;;
                 h)
             usage
             exit 1
             ;;
         p)
             PLUGIN_NAME=$OPTARG
             ;;
         o)
             FILE_OWNER=$OPTARG
             ;;
         s)
             PLUGIN_SOURCE=$OPTARG
             ;;
         ?)
                         log "additional param"
             usage
             exit
             ;;
     esac
done

log "Plugin name need to be verified for Dependency  : ${PLUGIN_NAME}"
log "Plugin OWNER  : ${FILE_OWNER}"
log "Plugin PLUGIN_SOURCE  : ${PLUGIN_SOURCE}"
log "PLUGIN_DIR  : ${PLUGIN_DIR}"

if [ -z $PLUGIN_NAME ] ;
then
     log "Param validation error"
     usage
     exit 1
fi
#plugin_name_version=${PLUGIN_NAME}
plugin_name_version=`echo ${PLUGIN_NAME} | sed 's/,/ /g' | sed 'N;s/\n//' `
#log "plugin name ${plugin_name_version}"
IFS=' ' read -a plugins <<< $plugin_name_version
if [ ${#plugins[@]} -gt 0 ]; then
     log "plugin count need to be installed ${#plugins[@]}"
     for plugin in "${plugins[@]}"
     do
       installplugin "$plugin"
       checkdependency "$plugin"
     done
else
     log "Param validation error"
     usage
     exit 1
fi

